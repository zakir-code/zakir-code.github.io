"use strict";(self["webpackChunkping_wallet"]=self["webpackChunkping_wallet"]||[]).push([[9973],{29973:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-md"},[a("b-card",[a("b-card-title",[t._v(" What's State Sync? ")]),t._v(" The Tendermint Core 0.34 release includes support for state sync, which allows a new node to join a network by fetching a snapshot of the application state at a recent height instead of fetching and replaying all historical blocks. This can reduce the time needed to sync with the network from days to minutes. Click "),a("a",{attrs:{href:"https://blog.cosmos.network/cosmos-sdk-state-sync-guide-99e4cf43be2f"}},[t._v("here")]),t._v(" for more infomation. ")],1),a("b-card",[a("b-card-title",[t._v(" Starting New Node From State Sync ")]),a("b",{staticClass:"mt-1"},[t._v("1. Install Binary (Version: "+t._s(t.app_version)+")")]),a("br"),t._v(" We need to install the binary first and make sure that the version is the one currently in use on mainnet. "),a("br"),a("br"),a("b",{staticClass:"mt-1"},[t._v("2. Enable State Sync")]),a("br"),t._v(" We can configure Tendermint to use state sync in "),a("code",[t._v("$DAEMON_HOME/config/config.toml")]),t._v(". "),a("ul",{staticClass:"mt-1"},t._l(t.error,(function(e){return a("li",{key:e,staticClass:"text-danger"},[t._v(" "+t._s(e)+" ")])})),0),a("b-form-textarea",{staticClass:"my-1",attrs:{id:"textarea-state",state:t.valid,readonly:"",placeholder:"Loading...",rows:"7"},on:{change:function(e){return t.check()}},model:{value:t.state,callback:function(e){t.state=e},expression:"state"}}),a("b",{staticClass:"mt-1"},[t._v("3. Start the daemon: "),t.daemon?a("span",[a("code",[t._v(t._s(t.daemon)+" start")])]):t._e()]),a("br"),t._v(" If you are resetting node, run "),a("code",[t._v(t._s(t.daemon)+" unsafe-reset-all")]),t._v(" or "),a("code",[t._v(t._s(t.daemon)+" tendermint unsafe-reset-all --home ~/.HOME")]),t._v(" before you start the daemon. ")],1),a("b-card",[a("b-card-title",[t._v(" Enable Snapshot For State Sync ")]),t._v(" To make state sync works, we can enable snapshot in "),a("code",[t._v("$DAEMON_HOME/config/app.toml")]),a("b-form-textarea",{staticClass:"mt-1",attrs:{id:"snapshot",readonly:"",rows:"8"},model:{value:t.snapshot,callback:function(e){t.snapshot=e},expression:"snapshot"}})],1)],1)},s=[],r=(a(92222),a(69600),a(21249),a(41539),a(78783),a(33948),a(60285),a(41637),a(23157),a(73689),a(54747),a(74916),a(23123),a(9653),a(15306),a(77601),a(73210),a(8775)),o=a(49379),i=a(333),c=a(28972),h={components:{BCard:r._,BCardTitle:o._,BFormTextarea:i.y},data:function(){var t=this.$store.state.chains.selected,e=t.rpc,a=t.snapshot_provider,n="";if(e&&Array.isArray(e)&&e.length>0){var s=e;1===s.length&&(s=s.concat(s)),n=s.map((function(t){var e=new URL(t);return""===e.port?"".concat(e.protocol,"//").concat(e.hostname,":").concat(e.protocol.startsWith("https")?"443":"80"):"".concat(e.protocol,"//").concat(e.hostname,":").concat(e.port)})).join(",")}var r=a,o=r?'# Comma separated list of nodes to keep persistent connections to \npersistent_peers = "'.concat(r,'" '):"OMGï¼ There is NO available providers, but you can try it.";return{app_version:"",snapshot_provider:a,servers:n,providers:o,height:0,hash:"",error:[],state:"",valid:!1,daemon:"",snapshot:"[state-sync]\n# snapshot-interval specifies the block interval at which local state sync snapshots are\n# taken (0 to disable). Must be a multiple of pruning-keep-every.\nsnapshot-interval = 1000\n\n# snapshot-keep-recent specifies the number of recent snapshots to keep and serve (0 to keep all). Each snapshot is about 500MiB\nsnapshot-keep-recent = 2"}},created:function(){var t=this,e=1e3;this.$http.getLatestBlock().then((function(a){var n=a.block.header.height;n>3*e&&t.$http.getBlockByHeight(Math.trunc((n-3*e)/e)*e).then((function(e){t.hash=(0,c.toHex)((0,c.fromBase64)(e.block_id.hash)),t.height=e.block.header.height,t.state='[statesync]\nenable = true\nrpc_servers = "'.concat(t.servers,'"\ntrust_height = ').concat(t.height,'\ntrust_hash = "').concat(t.hash,'"\ntrust_period = "168h"  # 2/3 of unbonding time'),t.check()})),t.$http.getNodeInfo().then((function(e){t.app_version=e.application_version.version,t.daemon=e.application_version.app_name})).catch()}))},methods:{check:function(){var t=this;return this.valid=!0,this.error=[],this.state.split("\n").forEach((function(e){var a=t.kv(e);"trust_height"===a[0]&&Number(a[1])<1&&(t.valid=!1,t.error.push("Trust Height should be set.")),"trust_hash"===a[0]&&a[1].length<10&&(t.valid=!1,t.error.push("Trust Hash is invalid.")),"rpc_servers"===a[0]&&(a[1].indexOf(",")>1?a[1].replace(/"/g,"").split(",").forEach((function(e){var a=/^(.)+:\d+$/g;a.test(e)||(t.valid=!1,t.error.push('"'.concat(e,'" is not a valid host. Make sure that the port is added.')))})):(t.valid=!1,t.error.push("No RPC serser is configured.")))})),this.valid},kv:function(t){if(t&&t.indexOf("=")>0){var e=t.split("=");return[e[0].trim(),e[1].trim()]}return[]}}},l=h,p=a(1001),d=(0,p.Z)(l,n,s,!1,null,null,null),u=d.exports}}]);