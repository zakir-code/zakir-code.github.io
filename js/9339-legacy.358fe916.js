"use strict";(self["webpackChunkping_wallet"]=self["webpackChunkping_wallet"]||[]).push([[9339],{39339:function(t,e,s){s.r(e),s.d(e,{default:function(){return T}});var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"px-0"},[s("b-tabs",[s("b-tab",{attrs:{title:"Group By Validator"}},[s("b-card",[s("b-alert",{attrs:{variant:"danger",show:t.syncing}},[s("div",{staticClass:"alert-body"},[s("span",[t._v("No new blocks have been produced since "),s("strong",[t._v(t._s(t.latestTime))])])])]),s("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[s("b-row",[s("b-col",{attrs:{md:"3"}},[s("h4",[t._v("#"+t._s(t.height))])]),s("b-col",{attrs:{md:"9"}},[s("b-input-group",[s("b-input-group-prepend",{attrs:{"is-text":""}},[s("b-form-checkbox",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Only missed blocks",name:"viewMissed"},model:{value:t.missedFilter,callback:function(e){t.missedFilter=e},expression:"missedFilter"}})],1),s("b-form-input",{attrs:{placeholder:"Keywords to filter validators"},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}}),s("b-input-group-append",[s("b-button",{attrs:{to:"./uptime/my",variant:"primary"}},[t._v(" Favorite ")])],1)],1)],1)],1)],1),s("b-row",t._l(t.uptime,(function(e,r){return s("b-col",{key:r,staticClass:"text-truncate",attrs:{sm:"12",md:"4",xl:"3"}},[s("div",{staticClass:"d-flex justify-content-between"},[s("b-form-checkbox",{staticClass:"custom-control-warning text-truncate",attrs:{value:t.chain+"#"+e.address},on:{change:function(s){return t.pinValidator(t.chain+"#"+e.address)}},model:{value:t.pinned,callback:function(e){t.pinned=e},expression:"pinned"}},[s("span",{staticClass:"d-inline-block text-truncate font-weight-bold align-bottom"},[t._v(t._s(r+1)+" "+t._s(e.validator.moniker))])]),t.missing[e.address]?s("span",[t.missing[e.address].missed_blocks_counter>0?s("b-badge",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.v-danger",modifiers:{hover:!0,"v-danger":!0}}],staticClass:"text-danger text-bolder",attrs:{variant:"light-danger",title:t.missing[e.address].missed_blocks_counter+" missed blocks"}},[t._v(" "+t._s(t.missing[e.address].missed_blocks_counter)+" ")]):s("b-badge",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.v-success",modifiers:{hover:!0,"v-success":!0}}],attrs:{variant:"light-success",title:"Perfect! No missed blocks"}},[t._v(" 0 ")])],1):t._e()],1),s("b-skeleton-wrapper",{attrs:{loading:t.loading},scopedSlots:t._u([{key:"loading",fn:function(){return[s("b-skeleton",{attrs:{width:"100%"}})]},proxy:!0},{key:"default",fn:function(){return[s("div",{staticClass:"d-flex justify-content-between align-self-stretch flex-wrap"},t._l(t.blocks,(function(r,o){return s("div",{key:o,staticStyle:{width:"1.5%"}},[s("router-link",{attrs:{to:"./blocks/"+r.height}},[s("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.v-second",modifiers:{hover:!0,"v-second":!0}}],staticClass:"m-auto",class:r.sigs&&r.sigs[e.address]?r.sigs[e.address]:"bg-light-success",attrs:{title:r.height}},[t._v("Â ")])])],1)})),0)]},proxy:!0}],null,!0)})],1)})),1)],1)],1),s("b-tab",{attrs:{title:"Group By Proposer"}},[s("b-card",[s("b-row",[s("b-col",{attrs:{md:"3",sm:"12"}},[s("h4",[t._v("#"+t._s(t.height))])]),s("b-col",{attrs:{md:"3",sm:"12"}},[s("b-input-group",{attrs:{prepend:"Fetch Frequency"}},[s("b-form-select",{attrs:{id:"frequency",placeholder:"Frequency to fetch data"},on:{change:function(e){return t.onFrequencyChange()}},model:{value:t.frequency,callback:function(e){t.frequency=e},expression:"frequency"}},[s("b-form-select-option",{attrs:{value:"6000"}},[t._v(" 6s ")]),s("b-form-select-option",{attrs:{value:"2000"}},[t._v(" 2s ")]),s("b-form-select-option",{attrs:{value:"1000"}},[t._v(" 1s ")])],1)],1)],1),s("b-col",{attrs:{sm:"12",md:"6"}},[s("b-input-group",{attrs:{prepend:"Qty of absent validators"}},[s("b-form-input",{attrs:{id:"threshold",placeholder:"Absent validator number in blocks"},model:{value:t.threshold,callback:function(e){t.threshold=e},expression:"threshold"}})],1)],1)],1)],1),s("b-row",t._l(t.proposerViewData,(function(e,r){return s("b-col",{key:r,staticClass:"text-truncate",attrs:{md:"4",sm:"12"}},[t._v(" "+t._s(e.name)+" "),e.proposed>0?s("b-badge",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.v-second",modifiers:{hover:!0,"v-second":!0}}],attrs:{title:e.proposed>0?Number(e.counter/e.proposed*100).toFixed(2)+" %":"",variant:e.counter>0?"light-danger":"light-success"}},[t._v(" "+t._s(e.counter)+" / "+t._s(e.proposed)+" ")]):t._e()],1)})),1)],1)],1)],1)},o=[],i=(s(74916),s(23123),s(21249),s(91038),s(78783),s(82481),s(9653),s(57327),s(41539),s(82526),s(41817),s(2707),s(54747),s(47941),s(26833),s(69826),s(26253)),n=s(50725),a=s(22183),c=s(90224),l=s(8775),d=s(73106),u=s(15193),h=s(26034),p=s(65098),b=s(90895),m=s(78959),f=s(4060),v=s(14777),g=s(46499),k=s(27754),_=s(22418),y=s(58887),B=s(51015),x=s(5870),w=s(54333),C=s(28972),F={components:{BRow:i.T,BCol:n.l,BFormInput:a.e,BFormGroup:c.x,BCard:l._,BAlert:d.F,BButton:u.T,BBadge:h.k,BFormCheckbox:p.l,BFormSelect:b.K,BFormSelectOption:m.c,BInputGroup:f.w,BSkeleton:v.u,BSkeletonWrapper:g.x,BInputGroupPrepend:k.P,BInputGroupAppend:_.B,BTabs:y.M,BTab:B.L},directives:{"b-tooltip":x.o},data:function(){var t=this.$route.params.chain,e=localStorage.getItem("pinned")?localStorage.getItem("pinned").split(","):"";return{height:0,loading:!0,missedFilter:!1,pinned:e,chain:t,query:"",validators:[],missing:{},blocks:Array.from("0".repeat(50)).map((function(t){return{sigs:{},height:Number(t)}})),syncing:!1,latestTime:"",threshold:10,proposers:{},absentValsInBlock:{},numOfBlock:1e3,temp:0,frequency:6e3}},computed:{uptime:function(){var t=this,e=this.query?this.validators.filter((function(e){return String(e.description.moniker).indexOf(t.query)>-1})):this.validators;e.sort((function(t,e){return e.delegator_shares-t.delegator_shares}));var s=e.map((function(e){return{validator:e.description,address:t.hex2base64((0,w.consensusPubkeyToHexAddress)(e.consensus_pubkey))}}));return this.missedFilter?s.filter((function(e){return t.missing[e.address].missed_blocks_counter>0})):s},proposerViewData:function(){var t=this,e={};return this.validators.forEach((function(s){e[t.hex2base64((0,w.consensusPubkeyToHexAddress)(s.consensus_pubkey))]={name:s.description.moniker,counter:0,proposed:0}})),Object.keys(this.proposers).forEach((function(s){var r=t.absentValsInBlock[s]||0;e[t.proposers[s]]&&(r>t.threshold&&(e[t.proposers[s]].counter+=1),e[t.proposers[s]].proposed+=1)})),Object.values(e).sort((function(t,e){return e.counter-t.counter}))}},created:function(){var t=this,e=JSON.parse((0,w.getCachedValidators)(this.$route.params.chain));e&&(this.validators=e),this.$http.getValidatorList().then((function(e){t.validators=e})),this.$http.getSlashingSigningInfo().then((function(e){e.info&&e.info.forEach((function(e){if(e.address){var s=(0,C.toBase64)((0,C.fromBech32)(e.address).data);t.missing[s]=e}}))})),this.initBlocks()},beforeDestroy:function(){this.blocks=[],this.syncing=!1,clearInterval(this.timer)},methods:{pinValidator:function(){localStorage.setItem("pinned",this.pinned)},initBlocks:function(){var t=this;this.$http.getLatestBlock().then((function(e){var s=e.block.last_commit.height;(0,w.timeIn)(e.block.header.time,3,"m")?t.syncing=!0:t.syncing=!1,t.latestTime=(0,w.toDay)(e.block.header.time,"long");for(var r=[],o=Promise.resolve(),i=function(e){r.unshift({sigs:{},height:e>0?e:0}),e>s-48&&e>0&&(o=o.then((function(){return new Promise((function(s){t.fetch_status(e,s)}))})))},n=s-1;n>s-50;n-=1)i(n);var a=t.initColor();e.block.last_commit.signatures.forEach((function(t){t.validator_address&&(a[t.validator_address]="bg-success")})),r.push({sigs:a,height:s}),t.blocks=r,t.timer=setInterval(t.fetch_latest,t.frequency),t.loading=!1}))},initColor:function(){var t=this,e={};return this.validators.forEach((function(s){e[t.hex2base64((0,w.consensusPubkeyToHexAddress)(s.consensus_pubkey))]="bg-danger"})),e},onFrequencyChange:function(){clearInterval(this.timer),this.timer=setInterval(this.fetch_latest,this.frequency)},hex2base64:function(t){return(0,C.toBase64)((0,C.fromHex)(t))},fetch_status:function(t,e){var s=this;this.$http.getBlockByHeight(t).then((function(r){e();var o=s.blocks.find((function(e){return e.height===t}));if(o){var i=s.initColor();r.block.last_commit.signatures.forEach((function(t){t.validator_address&&(i[t.validator_address]="bg-success")})),s.$set(o,"sigs",i)}s.count(r.block)}))},count:function(t){var e=t.last_commit.signatures.reduce((function(t,e){return"BLOCK_ID_FLAG_COMMIT"!==e.block_id_flag?t+1:t}),0);this.$set(this.proposers,t.header.height,t.header.proposer_address),this.$set(this.absentValsInBlock,t.last_commit.height,e),e>=this.threshold&&(this.temp+=1)},fetch_latest:function(){var t=this;this.$http.getLatestBlock().then((function(e){var s=t.initColor();e.block.last_commit.signatures.forEach((function(t){t.validator_address&&(s[t.validator_address]="bg-success")})),t.height=e.block.header.height;var r=t.blocks.find((function(t){return t.height===e.block.last_commit.height}));"undefined"===typeof r&&(t.blocks.length>=50&&t.blocks.shift(),t.blocks.push({sigs:s,height:e.block.last_commit.height})),t.count(e.block)}))}}},I=F,q=s(1001),S=(0,q.Z)(I,r,o,!1,null,null,null),T=S.exports}}]);